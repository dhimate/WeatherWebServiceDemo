<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mapping="http://www.apama.com/schema/mapping/1.0"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       		http://www.apama.com/schema/mapping/1.0 http://www.apama.com/schema/mapping.xsd" default-lazy-init="true">
 
	
	<!-- This file is usually auto-generated by tooling -->
	 <!--  Event Parser Configuration -->
     
    <bean id="eventParserConfig" class="com.apama.adapters.config.EventParserBean">
        <property name="eventTypeXML">                                                          <!--  Event type XML -->
            <value>
                <![CDATA[<event name="GetCityWeatherByZIPType">
    <member name="ZIP" type="string"/>
  </event>
  <event name="MyRequest">
    <member name="GetCityWeatherByZIP" type="event" eventName="GetCityWeatherByZIPType"  wildcard="true"/>
  </event>
  <event name="MyResponse">
    <member name="GetCityWeatherByZIPResponse" type="event" eventName="GetCityWeatherByZIPResponseType"  wildcard="true"/>
  </event>
  <event name="GetCityWeatherByZIPResponseType">
    <member name="GetCityWeatherByZIPResult" type="event" eventName="GetCityWeatherByZIPResultType"  wildcard="true"/>
  </event>
  <event name="GetCityWeatherByZIPResultType">
    <member name="Success" type="string"/>
    <member name="ResponseText" type="string"/>
    <member name="State" type="string"/>
    <member name="City" type="string"/>
    <member name="WeatherStationCity" type="string"/>
    <member name="WeatherID" type="string"/>
    <member name="Description" type="string"/>
    <member name="Temperature" type="string"/>
    <member name="RelativeHumidity" type="string"/>
    <member name="Wind" type="string"/>
    <member name="Pressure" type="string"/>
    <member name="Visibility" type="string"/>
    <member name="WindChill" type="string"/>
    <member name="Remarks" type="string"/>
  </event>]]>
            </value>
        </property>
    </bean>


	<!-- Initial Context -->
	
	
	<bean id="apamaInitialContext" class="com.apama.adapters.config.initial.InitialContextBean">
        <property name="archiveContext">
            <bean class="com.apama.adapters.config.initial.ArchiveContextBean">
                <property name="archiveResource" value="file:WeatherWebServiceDemo.paar"/>
                <property name="stagingDir" value="stagingDirectory"/>
            </bean>
        </property>
        <property name="idlInitContext">
            <bean class="com.apama.adapters.config.initial.IdlInitContextBean">
                <property name="extensionRegistrarsList">
                    <list>
                        <value>com.progress.caf.extensions.idl.xmlSchema.XmlSchemaTypesExtensionRegistrar</value>
                    </list>
                </property>
            </bean>
        </property>
        <property name="springRelatedContext">
            <bean class="com.apama.adapters.config.initial.SpringRelatedContextBean">
                <property name="initPropertiesResource" value="file:WeatherWebServiceDemo.properties"/> 
            </bean>
        </property>
    </bean>
	
	
	<!-- Service Context -->
  
    <bean id="INSTANCE_1_Weather_WeatherSoap_GetCityWeatherByZIP_routeOperation_1" class="com.apama.adapters.config.service.ServiceContextBean">           <!-- Unique bean id for a particular ServiceContext -->
        <property name="initialContext" ref="apamaInitialContext"/>                                     <!--  Reference to Initial Context -->
        <property name="idlServiceContext">
            <bean class="com.apama.adapters.config.service.IdlServiceContextBean">
                <property name="idlUri" value="paar:///WeatherWebServiceDemo/Consume/Weather/Weather_WeatherSoap_GetCityWeatherByZIP/Weather_WeatherSoap_GetCityWeatherByZIP.pidl"/>
            </bean>
        </property>
        <property name="mappingServiceContext">
            <bean class="com.apama.adapters.config.service.MappingServiceContextBean" autowire="byType">
                <property name="mappingRules">
<mapping:messageMapping xmlns:mapping="http://www.apama.com/schema/mapping/1.0" xmlns:metadata="http://www.apama.com/schema/mapping/toolingMetadata/1.0" xmlns:tns="http://ws.cdyne.com/WeatherWS/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<mapping:mapInput>
    <mapping:rule>
      <mapping:source><![CDATA[${eventToXml(apamaEventType['MyRequest'].apamaEvent['GetCityWeatherByZIP'],'http://ws.cdyne.com/WeatherWS/','',0)}]]></mapping:source>
      <mapping:target><![CDATA[${idl.param['parameters']}]]></mapping:target>
      <mapping:action><![CDATA[None]]></mapping:action>
      <mapping:type><![CDATA[INTERFACE_PARAM]]></mapping:type>
    </mapping:rule>
  </mapping:mapInput>
<mapping:mapOutput>
    <mapping:rule>
      <mapping:source><![CDATA[${idl.param['parameters']}]]></mapping:source>
      <mapping:target><![CDATA[${apamaEventType['MyResponse'].apamaEvent['GetCityWeatherByZIPResponse']}]]></mapping:target>
      <mapping:action><![CDATA[None]]></mapping:action>
      <mapping:type><![CDATA[INTERFACE_PARAM]]></mapping:type>
    </mapping:rule>
  </mapping:mapOutput>
<mapping:mapFault name="default_fault"/>
</mapping:messageMapping>
                </property>  
            </bean>
        </property>
        <property name="routingContext">
            <bean class="com.apama.adapters.config.service.RoutingContextBean">
                <property name="routeName" value="Weather_WeatherSoap_GetCityWeatherByZIP_route"/>                   <!-- CAF Route Name  -->
            </bean>
        </property>
    </bean>
		
</beans>